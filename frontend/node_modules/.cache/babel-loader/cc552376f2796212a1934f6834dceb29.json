{"ast":null,"code":"var _jsxFileName = \"/Users/shravanmeena/Desktop/ecommerce/frontend/src/screens/OrderScreen.js\";\nimport React, { Component } from \"react\";\nimport { deliveredOrder, payOrder } from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport { Col, Container, ListGroup, Row, Image, Card, Button, Alert } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n\n    this.successPaymentHandler = (details, data) => {\n      const paymentResult = {\n        id: details.id,\n        status: details.status,\n        update_time: details.update_time,\n        email_address: details.payer.email_address\n      };\n      this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    };\n\n    this.orderDeliveredHandler = (details, data) => {\n      this.props.dispatch(deliveredOrder(this.props.match.params.id));\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    };\n\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false\n    };\n  }\n\n  componentDidMount() {\n    const addPaypalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get(`http://localhost:5000/api/config/paypal`);\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true\n        });\n      };\n\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    };\n    axios.get(`http://localhost:5000/api/orders/${this.props.match.params.id}`, config).then(response => {\n      this.setState({\n        data: response.data\n      });\n\n      if (!response.data.isPaid) {\n        if (!window.paypal) {\n          addPaypalScript();\n        } else {\n          this.setState({\n            sdkReady: true\n          });\n        }\n      }\n    }).catch(error => {\n      console.log(error);\n    }); // order paid or not\n    // console.log(this.state.data);\n  }\n\n  render() {\n    const order = this.state.data;\n    const user = this.props.getLoginInfoData;\n\n    if (!order.shippingAddress && !order.orderItems) {\n      return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          ms: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Order \", order._id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Shipping:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Name: \", user.userInfo.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Email: \", user.userInfo.email]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Address: \", order.shippingAddress[0].address, \" \", order.shippingAddress[0].city, \" \", order.shippingAddress[0].postalCode, \" \", order.shippingAddress[0].country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 17\n              }, this), order.isDelivered ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Delivere at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Delivered\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Payment:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Method: \", order.paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 17\n              }, this), order.isPaid ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Paid at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Paid\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Order Items:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 17\n              }, this), order.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Cart is empty\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: order.orderItems.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                    children: /*#__PURE__*/_jsxDEV(Row, {\n                      children: [/*#__PURE__*/_jsxDEV(Col, {\n                        md: 1,\n                        children: /*#__PURE__*/_jsxDEV(Image, {\n                          src: item.image,\n                          alt: item.name,\n                          fluid: true,\n                          rounded: true\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 162,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 161,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        children: /*#__PURE__*/_jsxDEV(Link, {\n                          to: `/product/${item.product}`,\n                          children: item.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 170,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 169,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        md: 4,\n                        children: [item.qty, \" x $\", item.price, \" = $\", item.qty * item.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 175,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 160,\n                      columnNumber: 27\n                    }, this)\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                variant: \"flush\",\n                children: [/*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.itemsPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 199,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 203,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.shippingPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 202,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Tax\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 208,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.taxPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 209,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 212,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.totalPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 17\n              }, this), !order.isPaid && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: !this.state.sdkReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                  amount: order.totalPrice,\n                  onSuccess: (details, data) => this.successPaymentHandler(details, data)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 19\n              }, this), user.isAdmin && order.isPaid && !order.isDelivered && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn btn-block\",\n                  type: \"button\",\n                  children: \"Mark As Delivered\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);","map":{"version":3,"sources":["/Users/shravanmeena/Desktop/ecommerce/frontend/src/screens/OrderScreen.js"],"names":["React","Component","deliveredOrder","payOrder","PayPalButton","connect","CheckoutSteps","axios","Loader","Col","Container","ListGroup","Row","Image","Card","Button","Alert","Link","OrderScreen","constructor","successPaymentHandler","details","data","paymentResult","id","status","update_time","email_address","payer","props","dispatch","match","params","setTimeout","window","location","reload","orderDeliveredHandler","state","taxPrice","shippingPrice","totalPrice","itemsPrice","sdkReady","componentDidMount","addPaypalScript","clientId","get","script","document","createElement","type","src","async","onload","setState","body","appendChild","token","getLoginInfoData","userInfo","config","headers","Authorization","then","response","isPaid","paypal","catch","error","console","log","render","order","user","shippingAddress","orderItems","_id","name","email","address","city","postalCode","country","isDelivered","paidAt","paymentMethod","length","map","item","index","image","product","qty","price","isAdmin","mapStateToProps","userLogin","getCartData","cart","getOrderDetailsData","orderDetails","getOrderPaymentData","orderPay"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { deliveredOrder, payOrder } from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport {\n  Col,\n  Container,\n  ListGroup,\n  Row,\n  Image,\n  Card,\n  Button,\n  Alert,\n} from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false,\n    };\n  }\n\n  componentDidMount() {\n    const addPaypalScript = async () => {\n      const { data: clientId } = await axios.get(\n        `http://localhost:5000/api/config/paypal`\n      );\n\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true,\n        });\n      };\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    };\n    axios\n      .get(\n        `http://localhost:5000/api/orders/${this.props.match.params.id}`,\n        config\n      )\n      .then((response) => {\n        this.setState({\n          data: response.data,\n        });\n\n        if (!response.data.isPaid) {\n          if (!window.paypal) {\n            addPaypalScript();\n          } else {\n            this.setState({\n              sdkReady: true,\n            });\n          }\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n    // order paid or not\n    // console.log(this.state.data);\n  }\n\n  successPaymentHandler = (details, data) => {\n    const paymentResult = {\n      id: details.id,\n      status: details.status,\n      update_time: details.update_time,\n      email_address: details.payer.email_address,\n    };\n    this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n\n    setTimeout(() => {\n      window.location.reload();\n    }, 500);\n  };\n\n  orderDeliveredHandler = (details, data) => {\n    this.props.dispatch(deliveredOrder(this.props.match.params.id));\n    setTimeout(() => {\n      window.location.reload();\n    }, 500);\n  };\n\n  render() {\n    const order = this.state.data;\n\n    const user = this.props.getLoginInfoData;\n    if (!order.shippingAddress && !order.orderItems) {\n      return <Loader />;\n    }\n\n    return (\n      <Container className='py-5'>\n        <Row>\n          <Col ms={8}>\n            <h4>Order {order._id}</h4>\n\n            <ListGroup variant='flush'>\n              <ListGroup.Item>\n                <h4>Shipping:</h4>\n                <p>Name: {user.userInfo.name}</p>\n                <p>Email: {user.userInfo.email}</p>\n                <p>\n                  Address: {order.shippingAddress[0].address}{\" \"}\n                  {order.shippingAddress[0].city}{\" \"}\n                  {order.shippingAddress[0].postalCode}{\" \"}\n                  {order.shippingAddress[0].country}\n                </p>\n\n                {order.isDelivered ? (\n                  <Alert variant='success'>Delivere at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Delivered</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Payment:</h4>\n                <p>Method: {order.paymentMethod}</p>\n                {order.isPaid ? (\n                  <Alert variant='success'>Paid at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Paid</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Order Items:</h4>\n                {order.orderItems.length === 0 ? (\n                  <p>Cart is empty</p>\n                ) : (\n                  <ListGroup variant='flush'>\n                    {order.orderItems.map((item, index) => {\n                      return (\n                        <ListGroup.Item key={index}>\n                          <Row>\n                            <Col md={1}>\n                              <Image\n                                src={item.image}\n                                alt={item.name}\n                                fluid\n                                rounded\n                              />\n                            </Col>\n                            <Col>\n                              <Link to={`/product/${item.product}`}>\n                                {item.name}\n                              </Link>\n                            </Col>\n\n                            <Col md={4}>\n                              {item.qty} x ${item.price} = $\n                              {item.qty * item.price}\n                            </Col>\n                          </Row>\n                        </ListGroup.Item>\n                      );\n                    })}\n                  </ListGroup>\n                )}\n              </ListGroup.Item>\n            </ListGroup>\n          </Col>\n\n          <Col md={4}>\n            <Card>\n              <ListGroup variant='flush'>\n                <ListGroup.Item>\n                  <h4>Order Summary</h4>\n                </ListGroup.Item>\n\n                <ListGroup.Item variant='flush'>\n                  <Row>\n                    <Col>Items</Col>\n                    <Col>${order.itemsPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Shipping</Col>\n                    <Col>${order.shippingPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Tax</Col>\n                    <Col>${order.taxPrice}</Col>\n                  </Row>\n                  <Row>\n                    <Col>Total</Col>\n                    <Col>${order.totalPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n                {!order.isPaid && (\n                  <ListGroup.Item>\n                    {!this.state.sdkReady ? (\n                      <Loader />\n                    ) : (\n                      <PayPalButton\n                        amount={order.totalPrice}\n                        onSuccess={(details, data) =>\n                          this.successPaymentHandler(details, data)\n                        }\n                      />\n                    )}\n                  </ListGroup.Item>\n                )}\n\n                {user.isAdmin && order.isPaid && !order.isDelivered && (\n                  <ListGroup.Item>\n                    <Button className='btn btn-block' type='button'>\n                      Mark As Delivered\n                    </Button>\n                  </ListGroup.Item>\n                )}\n              </ListGroup>\n            </Card>\n          </Col>\n        </Row>\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay,\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);\n"]},"metadata":{},"sourceType":"module"}