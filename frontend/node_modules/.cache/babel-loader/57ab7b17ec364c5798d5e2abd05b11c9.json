{"ast":null,"code":"var _jsxFileName = \"/Users/shravanmeena/Desktop/ecommerce/frontend/src/screens/OrderScreen.js\";\nimport React, { Component } from \"react\";\nimport { createOrder, getOrderDetails, payOrder } from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport { Col, Container, ListGroup, Row, Image, Card, Button, Alert } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n\n    this.placeOrderHandler = () => {\n      const cart = this.props.getCartData;\n      const {\n        taxPrice,\n        shippingPrice,\n        totalPrice,\n        itemsPrice\n      } = this.state;\n      this.props.dispatch(createOrder({\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        paymentMethod: cart.paymentAddress.paymentMethod,\n        taxPrice,\n        shippingPrice,\n        totalPrice,\n        itemsPrice\n      }));\n      this.props.history.push(`/order/success`);\n    };\n\n    this.addDecimals = num => {\n      return (Math.round(num * 100) / 100).toFixed(2);\n    };\n\n    this.successPaymentHandler = (details, data) => {\n      const paymentResult = {\n        id: details.id,\n        status: details.status,\n        update_time: details.update_time,\n        email_address: details.payer.email_address\n      };\n      this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    };\n\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false\n    };\n  }\n\n  componentDidMount() {\n    const addPaypalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get(`http://localhost:5000/api/config/paypal`);\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true\n        });\n      };\n\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    };\n    axios.get(`http://localhost:5000/api/orders/${this.props.match.params.id}`, config).then(response => {\n      this.setState({\n        data: response.data\n      });\n\n      if (!response.data.isPaid) {\n        if (!window.paypal) {\n          addPaypalScript();\n        } else {\n          this.setState({\n            sdkReady: true\n          });\n        }\n      }\n    }).catch(error => {\n      console.log(error);\n    }); // order paid or not\n    // console.log(this.state.data);\n  }\n\n  render() {\n    const order = this.state.data;\n    const user = this.props.getLoginInfoData;\n\n    if (!order.shippingAddress && !order.orderItems) {\n      return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          ms: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Order \", order._id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Shipping:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Name: \", user.userInfo.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Email: \", user.userInfo.email]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Address: \", order.shippingAddress[0].address, \" \", order.shippingAddress[0].city, \" \", order.shippingAddress[0].postalCode, \" \", order.shippingAddress[0].country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 17\n              }, this), order.isDelivered ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Delivere at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Delivered\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Payment:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Method: \", order.paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 17\n              }, this), order.isPaid ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Paid at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Paid\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Order Items:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 17\n              }, this), order.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Cart is empty\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: order.orderItems.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                    children: /*#__PURE__*/_jsxDEV(Row, {\n                      children: [/*#__PURE__*/_jsxDEV(Col, {\n                        md: 1,\n                        children: /*#__PURE__*/_jsxDEV(Image, {\n                          src: item.image,\n                          alt: item.name,\n                          fluid: true,\n                          rounded: true\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 179,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 178,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        children: /*#__PURE__*/_jsxDEV(Link, {\n                          to: `/product/${item.product}`,\n                          children: item.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 187,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 186,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        md: 4,\n                        children: [item.qty, \" x $\", item.price, \" = $\", item.qty * item.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 192,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 177,\n                      columnNumber: 27\n                    }, this)\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 210,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 209,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                variant: \"flush\",\n                children: [/*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 215,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.itemsPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 216,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 214,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.shippingPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 221,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Tax\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 225,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.taxPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 226,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 224,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 229,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.totalPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 230,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 228,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 17\n              }, this), !order.isPaid && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: !this.state.sdkReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                  amount: order.totalPrice,\n                  onSuccess: (details, data) => this.successPaymentHandler(details, data)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);","map":{"version":3,"sources":["/Users/shravanmeena/Desktop/ecommerce/frontend/src/screens/OrderScreen.js"],"names":["React","Component","createOrder","getOrderDetails","payOrder","PayPalButton","connect","CheckoutSteps","axios","Loader","Col","Container","ListGroup","Row","Image","Card","Button","Alert","Link","OrderScreen","constructor","placeOrderHandler","cart","props","getCartData","taxPrice","shippingPrice","totalPrice","itemsPrice","state","dispatch","orderItems","cartItems","shippingAddress","paymentMethod","paymentAddress","history","push","addDecimals","num","Math","round","toFixed","successPaymentHandler","details","data","paymentResult","id","status","update_time","email_address","payer","match","params","setTimeout","window","location","reload","sdkReady","componentDidMount","addPaypalScript","clientId","get","script","document","createElement","type","src","async","onload","setState","body","appendChild","token","getLoginInfoData","userInfo","config","headers","Authorization","then","response","isPaid","paypal","catch","error","console","log","render","order","user","_id","name","email","address","city","postalCode","country","isDelivered","paidAt","length","map","item","index","image","product","qty","price","mapStateToProps","userLogin","getOrderDetailsData","orderDetails","getOrderPaymentData","orderPay"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  createOrder,\n  getOrderDetails,\n  payOrder,\n} from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport {\n  Col,\n  Container,\n  ListGroup,\n  Row,\n  Image,\n  Card,\n  Button,\n  Alert,\n} from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false,\n    };\n  }\n  placeOrderHandler = () => {\n    const cart = this.props.getCartData;\n    const { taxPrice, shippingPrice, totalPrice, itemsPrice } = this.state;\n    this.props.dispatch(\n      createOrder({\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        paymentMethod: cart.paymentAddress.paymentMethod,\n        taxPrice,\n        shippingPrice,\n        totalPrice,\n        itemsPrice,\n      })\n    );\n\n    this.props.history.push(`/order/success`);\n  };\n\n  componentDidMount() {\n    const addPaypalScript = async () => {\n      const { data: clientId } = await axios.get(\n        `http://localhost:5000/api/config/paypal`\n      );\n\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true,\n        });\n      };\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    };\n    axios\n      .get(\n        `http://localhost:5000/api/orders/${this.props.match.params.id}`,\n        config\n      )\n      .then((response) => {\n        this.setState({\n          data: response.data,\n        });\n\n        if (!response.data.isPaid) {\n          if (!window.paypal) {\n            addPaypalScript();\n          } else {\n            this.setState({\n              sdkReady: true,\n            });\n          }\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n    // order paid or not\n    // console.log(this.state.data);\n  }\n  addDecimals = (num) => {\n    return (Math.round(num * 100) / 100).toFixed(2);\n  };\n\n  successPaymentHandler = (details, data) => {\n    const paymentResult = {\n      id: details.id,\n      status: details.status,\n      update_time: details.update_time,\n      email_address: details.payer.email_address,\n    };\n    this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n\n    setTimeout(() => {\n      window.location.reload();\n    }, 500);\n  };\n\n  render() {\n    const order = this.state.data;\n\n    const user = this.props.getLoginInfoData;\n    if (!order.shippingAddress && !order.orderItems) {\n      return <Loader />;\n    }\n\n    return (\n      <Container className='py-5'>\n        <Row>\n          <Col ms={8}>\n            <h4>Order {order._id}</h4>\n\n            <ListGroup variant='flush'>\n              <ListGroup.Item>\n                <h4>Shipping:</h4>\n                <p>Name: {user.userInfo.name}</p>\n                <p>Email: {user.userInfo.email}</p>\n                <p>\n                  Address: {order.shippingAddress[0].address}{\" \"}\n                  {order.shippingAddress[0].city}{\" \"}\n                  {order.shippingAddress[0].postalCode}{\" \"}\n                  {order.shippingAddress[0].country}\n                </p>\n\n                {order.isDelivered ? (\n                  <Alert variant='success'>Delivere at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Delivered</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Payment:</h4>\n                <p>Method: {order.paymentMethod}</p>\n                {order.isPaid ? (\n                  <Alert variant='success'>Paid at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Paid</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Order Items:</h4>\n                {order.orderItems.length === 0 ? (\n                  <p>Cart is empty</p>\n                ) : (\n                  <ListGroup variant='flush'>\n                    {order.orderItems.map((item, index) => {\n                      return (\n                        <ListGroup.Item key={index}>\n                          <Row>\n                            <Col md={1}>\n                              <Image\n                                src={item.image}\n                                alt={item.name}\n                                fluid\n                                rounded\n                              />\n                            </Col>\n                            <Col>\n                              <Link to={`/product/${item.product}`}>\n                                {item.name}\n                              </Link>\n                            </Col>\n\n                            <Col md={4}>\n                              {item.qty} x ${item.price} = $\n                              {item.qty * item.price}\n                            </Col>\n                          </Row>\n                        </ListGroup.Item>\n                      );\n                    })}\n                  </ListGroup>\n                )}\n              </ListGroup.Item>\n            </ListGroup>\n          </Col>\n\n          <Col md={4}>\n            <Card>\n              <ListGroup variant='flush'>\n                <ListGroup.Item>\n                  <h4>Order Summary</h4>\n                </ListGroup.Item>\n\n                <ListGroup.Item variant='flush'>\n                  <Row>\n                    <Col>Items</Col>\n                    <Col>${order.itemsPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Shipping</Col>\n                    <Col>${order.shippingPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Tax</Col>\n                    <Col>${order.taxPrice}</Col>\n                  </Row>\n                  <Row>\n                    <Col>Total</Col>\n                    <Col>${order.totalPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n                {!order.isPaid && (\n                  <ListGroup.Item>\n                    {!this.state.sdkReady ? (\n                      <Loader />\n                    ) : (\n                      <PayPalButton\n                        amount={order.totalPrice}\n                        onSuccess={(details, data) =>\n                          this.successPaymentHandler(details, data)\n                        }\n                      />\n                    )}\n                  </ListGroup.Item>\n                )}\n              </ListGroup>\n            </Card>\n          </Col>\n        </Row>\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay,\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);\n"]},"metadata":{},"sourceType":"module"}