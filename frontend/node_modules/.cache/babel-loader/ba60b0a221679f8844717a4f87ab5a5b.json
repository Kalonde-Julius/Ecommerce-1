{"ast":null,"code":"import _regeneratorRuntime from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/shravanmeena/Desktop/ecommerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{deliveredOrder,payOrder}from\"../actions/orderActions\";import{PayPalButton}from\"react-paypal-button-v2\";import{connect}from\"react-redux\";import CheckoutSteps from\"../component/CheckoutSteps\";import axios from\"axios\";import Loader from\"../component/Loader\";import{Col,Container,ListGroup,Row,Image,Card,Button,Alert}from\"react-bootstrap\";import{Link,Redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var OrderScreen=/*#__PURE__*/function(_Component){_inherits(OrderScreen,_Component);var _super=_createSuper(OrderScreen);function OrderScreen(){var _this;_classCallCheck(this,OrderScreen);_this=_super.call(this);_this.successPaymentHandler=function(details,data){var paymentResult={id:details.id,status:details.status,update_time:details.update_time,email_address:details.payer.email_address};_this.props.dispatch(payOrder(_this.props.match.params.id,paymentResult));setTimeout(function(){window.location.reload();},100);};_this.orderDeliveredHandler=function(){_this.props.dispatch(deliveredOrder(_this.props.match.params.id));setTimeout(function(){window.location.reload();},100);};_this.state={taxPrice:\"\",shippingPrice:\"\",totalPrice:\"\",itemsPrice:\"\",data:[],sdkReady:false};return _this;}_createClass(OrderScreen,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var addPaypalScript=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,clientId,script;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/config/paypal\");case 2:_yield$axios$get=_context.sent;clientId=_yield$axios$get.data;script=document.createElement(\"script\");script.type=\"text/javascript\";script.src=\"https://www.paypal.com/sdk/js?client-id=\".concat(clientId);script.async=true;script.onload=function(){_this2.setState({sdkReady:true});};document.body.appendChild(script);case 10:case\"end\":return _context.stop();}}},_callee);}));return function addPaypalScript(){return _ref.apply(this,arguments);};}();var token=this.props.getLoginInfoData.userInfo.token;var config={headers:{// \"Content-Type\": \"application/json\",\nAuthorization:\"Bearer \".concat(token)}};axios.get(\"/api/orders/\".concat(this.props.match.params.id),config).then(function(response){_this2.setState({data:response.data});if(!response.data.isPaid){if(!window.paypal){addPaypalScript();}else{_this2.setState({sdkReady:true});}}}).catch(function(error){console.log(error);});// order paid or not\n// console.log(this.state.data);\n}},{key:\"render\",value:function render(){var _this3=this;if(!this.props.getLoginInfoData.userInfo){return/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}var order=this.state.data;var user=this.props.getLoginInfoData;if(!order.shippingAddress&&!order.orderItems){return/*#__PURE__*/_jsx(Loader,{});}return/*#__PURE__*/_jsx(Container,{className:\"py-5\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{ms:8,children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Order \",order._id]}),/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Shipping:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Name: \",user.userInfo.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",user.userInfo.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Address: \",order.shippingAddress[0].address,\" \",order.shippingAddress[0].city,\" \",order.shippingAddress[0].postalCode,\" \",order.shippingAddress[0].country]}),order.isDelivered?/*#__PURE__*/_jsxs(Alert,{variant:\"success\",children:[\"Delivere at \",order.paidAt]}):/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:\"Not Delivered\"})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Payment:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Method: \",order.paymentMethod]}),order.isPaid?/*#__PURE__*/_jsxs(Alert,{variant:\"success\",children:[\"Paid at \",order.paidAt]}):/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:\"Not Paid\"})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Order Items:\"}),order.orderItems.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Cart is empty\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:order.orderItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" x $\",item.price,\" = $\",item.qty*item.price]})]})},index);})})]})]})]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h4\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsxs(ListGroup.Item,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Items\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.itemsPrice]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.shippingPrice]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.taxPrice]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.totalPrice]})]})]}),!order.isPaid&&/*#__PURE__*/_jsx(ListGroup.Item,{children:!this.state.sdkReady?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(PayPalButton,{amount:order.totalPrice,onSuccess:function onSuccess(details,data){return _this3.successPaymentHandler(details,data);}})}),user.userInfo.isAdmin&&order.isPaid&&!order.isDelivered&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{className:\"btn btn-block\",type:\"button\",onClick:this.orderDeliveredHandler,children:\"Mark As Delivered\"})})]})})})]})});}}]);return OrderScreen;}(Component);var mapStateToProps=function mapStateToProps(state){return{getLoginInfoData:state.userLogin,getCartData:state.cart,getOrderDetailsData:state.orderDetails,getOrderPaymentData:state.orderPay};};export default connect(mapStateToProps)(OrderScreen);","map":{"version":3,"sources":["/Users/shravanmeena/Desktop/ecommerce/frontend/src/screens/OrderScreen.js"],"names":["React","Component","deliveredOrder","payOrder","PayPalButton","connect","CheckoutSteps","axios","Loader","Col","Container","ListGroup","Row","Image","Card","Button","Alert","Link","Redirect","OrderScreen","successPaymentHandler","details","data","paymentResult","id","status","update_time","email_address","payer","props","dispatch","match","params","setTimeout","window","location","reload","orderDeliveredHandler","state","taxPrice","shippingPrice","totalPrice","itemsPrice","sdkReady","addPaypalScript","get","clientId","script","document","createElement","type","src","async","onload","setState","body","appendChild","token","getLoginInfoData","userInfo","config","headers","Authorization","then","response","isPaid","paypal","catch","error","console","log","order","user","shippingAddress","orderItems","_id","name","email","address","city","postalCode","country","isDelivered","paidAt","paymentMethod","length","map","item","index","image","product","qty","price","isAdmin","mapStateToProps","userLogin","getCartData","cart","getOrderDetailsData","orderDetails","getOrderPaymentData","orderPay"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { deliveredOrder, payOrder } from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport {\n  Col,\n  Container,\n  ListGroup,\n  Row,\n  Image,\n  Card,\n  Button,\n  Alert,\n} from \"react-bootstrap\";\nimport { Link, Redirect } from \"react-router-dom\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false,\n    };\n  }\n\n  componentDidMount() {\n    const addPaypalScript = async () => {\n      const { data: clientId } = await axios.get(`/api/config/paypal`);\n\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true,\n        });\n      };\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    };\n    axios\n      .get(`/api/orders/${this.props.match.params.id}`, config)\n      .then((response) => {\n        this.setState({\n          data: response.data,\n        });\n\n        if (!response.data.isPaid) {\n          if (!window.paypal) {\n            addPaypalScript();\n          } else {\n            this.setState({\n              sdkReady: true,\n            });\n          }\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n    // order paid or not\n    // console.log(this.state.data);\n  }\n\n  successPaymentHandler = (details, data) => {\n    const paymentResult = {\n      id: details.id,\n      status: details.status,\n      update_time: details.update_time,\n      email_address: details.payer.email_address,\n    };\n    this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n\n    setTimeout(() => {\n      window.location.reload();\n    }, 100);\n  };\n\n  orderDeliveredHandler = () => {\n    this.props.dispatch(deliveredOrder(this.props.match.params.id));\n    setTimeout(() => {\n      window.location.reload();\n    }, 100);\n  };\n\n  render() {\n    if (!this.props.getLoginInfoData.userInfo) {\n      return <Redirect to='/login' />;\n    }\n    const order = this.state.data;\n\n    const user = this.props.getLoginInfoData;\n    if (!order.shippingAddress && !order.orderItems) {\n      return <Loader />;\n    }\n\n    return (\n      <Container className='py-5'>\n        <Row>\n          <Col ms={8}>\n            <h4>Order {order._id}</h4>\n\n            <ListGroup variant='flush'>\n              <ListGroup.Item>\n                <h4>Shipping:</h4>\n                <p>Name: {user.userInfo.name}</p>\n                <p>Email: {user.userInfo.email}</p>\n                <p>\n                  Address: {order.shippingAddress[0].address}{\" \"}\n                  {order.shippingAddress[0].city}{\" \"}\n                  {order.shippingAddress[0].postalCode}{\" \"}\n                  {order.shippingAddress[0].country}\n                </p>\n\n                {order.isDelivered ? (\n                  <Alert variant='success'>Delivere at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Delivered</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Payment:</h4>\n                <p>Method: {order.paymentMethod}</p>\n                {order.isPaid ? (\n                  <Alert variant='success'>Paid at {order.paidAt}</Alert>\n                ) : (\n                  <Alert variant='danger'>Not Paid</Alert>\n                )}\n              </ListGroup.Item>\n\n              <ListGroup.Item>\n                <h4>Order Items:</h4>\n                {order.orderItems.length === 0 ? (\n                  <p>Cart is empty</p>\n                ) : (\n                  <ListGroup variant='flush'>\n                    {order.orderItems.map((item, index) => {\n                      return (\n                        <ListGroup.Item key={index}>\n                          <Row>\n                            <Col md={1}>\n                              <Image\n                                src={item.image}\n                                alt={item.name}\n                                fluid\n                                rounded\n                              />\n                            </Col>\n                            <Col>\n                              <Link to={`/product/${item.product}`}>\n                                {item.name}\n                              </Link>\n                            </Col>\n\n                            <Col md={4}>\n                              {item.qty} x ${item.price} = $\n                              {item.qty * item.price}\n                            </Col>\n                          </Row>\n                        </ListGroup.Item>\n                      );\n                    })}\n                  </ListGroup>\n                )}\n              </ListGroup.Item>\n            </ListGroup>\n          </Col>\n\n          <Col md={4}>\n            <Card>\n              <ListGroup variant='flush'>\n                <ListGroup.Item>\n                  <h4>Order Summary</h4>\n                </ListGroup.Item>\n\n                <ListGroup.Item variant='flush'>\n                  <Row>\n                    <Col>Items</Col>\n                    <Col>${order.itemsPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Shipping</Col>\n                    <Col>${order.shippingPrice}</Col>\n                  </Row>\n\n                  <Row>\n                    <Col>Tax</Col>\n                    <Col>${order.taxPrice}</Col>\n                  </Row>\n                  <Row>\n                    <Col>Total</Col>\n                    <Col>${order.totalPrice}</Col>\n                  </Row>\n                </ListGroup.Item>\n                {!order.isPaid && (\n                  <ListGroup.Item>\n                    {!this.state.sdkReady ? (\n                      <Loader />\n                    ) : (\n                      <PayPalButton\n                        amount={order.totalPrice}\n                        onSuccess={(details, data) =>\n                          this.successPaymentHandler(details, data)\n                        }\n                      />\n                    )}\n                  </ListGroup.Item>\n                )}\n\n                {user.userInfo.isAdmin && order.isPaid && !order.isDelivered && (\n                  <ListGroup.Item>\n                    <Button\n                      className='btn btn-block'\n                      type='button'\n                      onClick={this.orderDeliveredHandler}>\n                      Mark As Delivered\n                    </Button>\n                  </ListGroup.Item>\n                )}\n              </ListGroup>\n            </Card>\n          </Col>\n        </Row>\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay,\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);\n"]},"metadata":{},"sourceType":"module"}